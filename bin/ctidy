#!/bin/bash

# Ensure an argument is provided
if [[ -z "$1" ]]; then
    echo "Usage: ctidy <filename (without .cpp)> [optional flags]" >&2
    exit 1
fi

filename="$1.cpp"
output="$1"

# Check if the file exists
if [[ ! -f "$filename" ]]; then
    echo "Error: File '$filename' not found!" >&2
    exit 1
fi

extra_flags=""
for arg in "${@:2}"; do
    extra_flags="$extra_flags $arg"
done

echo "Syntax checking $filename with C++20." >&2

# Compile and run
clang++ -std=c++20 -fsyntax-only -Wall -Wextra -Werror -Wshadow -Wconversion "$filename" $extra_flags

echo "-- Done." >&2
