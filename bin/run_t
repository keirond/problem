#!/bin/bash

# Ensure an argument is provided
if [[ -z "$1" ]]; then
    echo "Usage: run_t <filename (without .cpp)> [optional flags]"
    exit 1
fi

filename="$1.cpp"
output="$1"

# Check if the file exists
if [[ ! -f "$filename" ]]; then
    echo "Error: File '$filename' not found!"
    exit 1
fi

extra_flags=""
for arg in "${@:2}"; do
    extra_flags="$extra_flags $arg"
done

# Compile and run
g++ -std=c++20 -O2 -Wall -Wextra -o "$output" "$filename" $extra_flags

# Run only if compilation was successful
if [[ $? -eq 0 ]]; then
    time ./"$output"
else
    echo "Compilation failed!"
    exit 1
fi
